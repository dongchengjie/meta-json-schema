{
  "port": {
    "anyOf": [
      { "type": "integer", "minimum": 0, "maximum": 65535 },
      {
        "type": "string",
        "pattern": "^(?:[1-9]\\d{0,3}|[1-5]\\d{4}|6[0-4]\\d{3}|65[0-4]\\d{2}|655[0-2]\\d|6553[0-5])$",
        "errorMessage": "无效的端口号(0~65535)"
      }
    ]
  },
  "portRange": {
    "pattern": "^(?:[1-9]\\d{0,3}|[1-5]\\d{4}|6[0-4]\\d{3}|65[0-4]\\d{2}|655[0-2]\\d|6553[0-5])$|^([1-9]\\d{0,3}|[1-5]\\d{4}|6[0-4]\\d{3}|65[0-4]\\d{2}|655[0-2]\\d|6553[0-5])-(?:[1-9]\\d{0,3}|[1-5]\\d{4}|6[0-4]\\d{3}|65[0-4]\\d{2}|655[0-2]\\d|6553[0-5])$",
    "errorMessage": "无效的端口范围(port 或 port1-port2)"
  },
  "ipv4": {
    "pattern": "^(?:(?:[1-9]?[0-9]|1[0-9][0-9]|2(?:[0-4][0-9]|5[0-5]))\\.){3}(?:[1-9]?[0-9]|1[0-9][0-9]|2(?:[0-4][0-9]|5[0-5]))$",
    "errorMessage": "无效的IPv4地址"
  },
  "ipv4Port": {
    "pattern": "^((?:(?:[1-9]?[0-9]|1[0-9][0-9]|2(?:[0-4][0-9]|5[0-5]))\\.){3}(?:[1-9]?[0-9]|1[0-9][0-9]|2(?:[0-4][0-9]|5[0-5])))?:(?:[0-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-5]{2}[0-3][0-5])$",
    "errorMessage": "无效的IPv4地址:端口"
  },
  "ipv4CIDR": {
    "pattern": "^(?:(?:[1-9]?[0-9]|1[0-9][0-9]|2(?:[0-4][0-9]|5[0-5]))\\.){3}(?:[1-9]?[0-9]|1[0-9][0-9]|2(?:[0-4][0-9]|5[0-5]))(?:\\/(?:[12]?[0-9]|3[0-2]))$",
    "errorMessage": "无效的IPv4网段"
  },
  "ipv6": {
    "pattern": "^([0-9a-fA-F]{1,4}(?::[0-9a-fA-F]{1,4}){7}|::|:(?::[0-9a-fA-F]{1,4}){1,6}|[0-9a-fA-F]{1,4}:(?::[0-9a-fA-F]{1,4}){1,5}|(?:[0-9a-fA-F]{1,4}:){2}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){3}(?::[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){4}(?::[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){5}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,6}:)$",
    "errorMessage": "无效的IPv6地址"
  },
  "ipv6Port": {
    "pattern": "^(\\[([0-9a-fA-F]{1,4}(?::[0-9a-fA-F]{1,4}){7}|::|:(?::[0-9a-fA-F]{1,4}){1,6}|[0-9a-fA-F]{1,4}:(?::[0-9a-fA-F]{1,4}){1,5}|(?:[0-9a-fA-F]{1,4}:){2}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){3}(?::[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){4}(?::[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){5}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,6}:)\\])?:(?:[0-9]|[1-9][0-9]{1,3}|[1-5][0-9]{4}|6[0-5]{2}[0-3][0-5])$",
    "errorMessage": "无效的[IPv6地址]:端口"
  },
  "ipv6CIDR": {
    "pattern": "^([0-9a-fA-F]{1,4}(?::[0-9a-fA-F]{1,4}){7}|::|:(?::[0-9a-fA-F]{1,4}){1,6}|[0-9a-fA-F]{1,4}:(?::[0-9a-fA-F]{1,4}){1,5}|(?:[0-9a-fA-F]{1,4}:){2}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){3}(?::[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){4}(?::[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){5}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,6}:)\\/(?:12[0-8]|1[01][0-9]|[1-9]?[0-9])$",
    "errorMessage": "无效的IPv6网段"
  },
  "ip": {
    "anyOf": [
      { "description": "ipv4", "$ref": "#/ipv4" },
      { "description": "ipv6", "$ref": "#/ipv6" }
    ]
  },
  "ipPort": {
    "anyOf": [
      { "description": "ipv4:端口", "$ref": "#/ipv4Port" },
      { "description": "[ipv6]:端口", "$ref": "#/ipv6Port" }
    ]
  },
  "ipCIDR": {
    "anyOf": [
      { "description": "ipv4网段", "$ref": "#/ipv4CIDR" },
      { "description": "ipv6网段", "$ref": "#/ipv6CIDR" }
    ]
  },
  "domain": {
    "pattern": "^(xn--)?[a-zA-Z0-9-_]+(?:\\.(xn--)?[a-zA-Z0-9-_]+)*$",
    "errorMessage": "无效的域名"
  },
  "domainWildcard": {
    "pattern": "^\\+?(xn--)?[a-zA-Z0-9-_*.]+(?:\\.(xn--)?[a-zA-Z0-9-_*]+)*$",
    "errorMessage": "无效的域名通配"
  },
  "server": {
    "anyOf": [
      { "description": "ipv4", "$ref": "#/ipv4" },
      { "description": "ipv4:端口", "$ref": "#/ipv4Port" },
      { "description": "ipv6", "$ref": "#/ipv6" },
      { "description": "[ipv6]:端口", "$ref": "#/ipv6Port" },
      { "description": "域名", "$ref": "#/domain" }
    ]
  },
  "url": {
    "pattern": "^.+:\\/\\/([^\\s/$.?#].[^\\s]*)\\.[^\\s]{2,}(\\/[^\\s]*)?$",
    "errorMessage": "无效的URL"
  },
  "httpUrl": {
    "pattern": "^https?:\\/\\/([^\\s/$.?#].[^\\s]*)\\.[^\\s]{2,}(\\/[^\\s]*)?$",
    "errorMessage": "无效的HTTP-URL"
  },
  "uuid": {
    "pattern": "^[0-9a-fA-F]{8}(?:-?[0-9a-fA-F]{4}){3}-?[0-9a-fA-F]{12}$",
    "errorMessage": "无效的UUID"
  }
}
