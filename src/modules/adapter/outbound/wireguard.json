{
  "type": "object",
  "title": "outbound-wireguard",
  "definitions": {
    "compatible": { "$ref": "../../../definitions/compatible.json" },
    "types": { "$ref": "../../../definitions/types.json" },
    "patterns": { "$ref": "../../../definitions/patterns.json" },
    "enums": { "$ref": "../../../definitions/enums.json" },
    "basic-option": { "$ref": "./base.json#/definitions/basic-option" },
    "smux": { "$ref": "./singmux.json" },
    "amnezia-wg-option": {
      "type": "object",
      "title": "AmneziaWG配置",
      "properties": {
        "jc": {
          "type": "integer",
          "title": "垃圾包数量",
          "description": "在握手前发送的随机垃圾包数量",
          "markdownDescription": "在握手前发送的随机垃圾包数量"
        },
        "jmin": {
          "type": "integer",
          "title": "垃圾包的最小字节大小",
          "description": "最大值为 1280 字节",
          "markdownDescription": "最大值为 1280 字节"
        },
        "jmax": {
          "type": "integer",
          "title": "垃圾包的最大字节大小",
          "description": "最大值为 1280 字节",
          "markdownDescription": "最大值为 1280 字节"
        },
        "s1": {
          "type": "integer",
          "title": "握手初始化包前缀随机字节数",
          "description": "在WireGuard握手初始化包（类型1）前填充的随机数据长度，用于干扰包头分析",
          "markdownDescription": "在WireGuard握手初始化包（类型1）前填充的随机数据长度，用于干扰包头分析"
        },
        "s2": {
          "type": "integer",
          "title": "握手响应包前缀随机字节数",
          "description": "在WireGuard握手响应包（类型2）前填充的随机数据长度",
          "markdownDescription": "在WireGuard握手响应包（类型2）前填充的随机数据长度"
        },
        "h1": {
          "type": "integer",
          "title": "消息类型1覆盖值（Handshake Init）",
          "description": "替换WireGuard握手初始化包（类型1）的固定协议头字段值",
          "markdownDescription": "替换WireGuard握手初始化包（类型1）的固定协议头字段值"
        },
        "h2": {
          "type": "integer",
          "title": "消息类型2覆盖值（Handshake Response）",
          "description": "替换WireGuard握手响应包（类型2）的固定协议头字段值",
          "markdownDescription": "替换WireGuard握手响应包（类型2）的固定协议头字段值"
        },
        "h3": {
          "type": "integer",
          "title": "消息类型3覆盖值（Data Packet）",
          "description": "替换WireGuard数据传输包（类型3）的固定协议头字段值",
          "markdownDescription": "替换WireGuard数据传输包（类型3）的固定协议头字段值"
        },
        "h4": {
          "type": "integer",
          "title": "消息类型4覆盖值（Keepalive）",
          "description": "替换WireGuard保活包（类型4）的固定协议头字段值",
          "markdownDescription": "替换WireGuard保活包（类型4）的固定协议头字段值"
        },
        "i1": {
          "type": "string",
          "title": "主协议伪装规则（CPS格式）",
          "description": "初始握手阶段的协议模仿规则",
          "markdownDescription": "初始握手阶段的协议模仿规则"
        },
        "i2": {
          "type": "string",
          "title": "辅助协议伪装规则（CPS格式）",
          "description": "扩展握手阶段的协议模仿规则",
          "markdownDescription": "扩展握手阶段的协议模仿规则"
        },
        "i3": {
          "type": "string",
          "title": "动态噪声注入规则（CPS格式）",
          "description": "在数据传输阶段插入的动态噪声规则",
          "markdownDescription": "在数据传输阶段插入的动态噪声规则"
        },
        "i4": {
          "type": "string",
          "title": "保留协议伪装规则（CPS格式）",
          "description": "备用伪装规则",
          "markdownDescription": "备用伪装规则"
        },
        "i5": {
          "type": "string",
          "title": "连接终止伪装规则（CPS格式）",
          "description": "连接关闭阶段的协议模仿规则",
          "markdownDescription": "连接关闭阶段的协议模仿规则"
        },
        "j1": {
          "type": "string",
          "title": "消息类型1动态伪装（CPS格式）",
          "description": "覆盖WireGuard类型1消息的完整动态规则",
          "markdownDescription": "覆盖WireGuard类型1消息的完整动态规则"
        },
        "j2": {
          "type": "string",
          "title": "消息类型2动态伪装（CPS格式）",
          "description": "覆盖WireGuard类型2消息的完整动态规则",
          "markdownDescription": "覆盖WireGuard类型2消息的完整动态规则"
        },
        "j3": {
          "type": "string",
          "title": "消息类型3动态伪装（CPS格式）",
          "description": "覆盖WireGuard类型3消息的完整动态规则",
          "markdownDescription": "覆盖WireGuard类型3消息的完整动态规则"
        },
        "itime": {
          "type": "integer",
          "title": "动态规则刷新间隔",
          "description": "单位:s",
          "markdownDescription": "单位:s"
        }
      }
    },
    "wireguard-peer-option": {
      "type": "object",
      "title": "peer配置",
      "required": ["server", "port"],
      "properties": {
        "server": {
          "$ref": "#/definitions/patterns/server",
          "title": "代理节点服务器",
          "description": "域名或IP",
          "markdownDescription": "域名或IP"
        },
        "port": {
          "$ref": "#/definitions/patterns/port",
          "title": "代理节点端口号",
          "description": "代理节点端口号",
          "markdownDescription": "代理节点端口号"
        },
        "public-key": {
          "$ref": "#/definitions/compatible/string",
          "title": "公钥",
          "description": "公钥",
          "markdownDescription": "公钥"
        },
        "pre-shared-key": {
          "$ref": "#/definitions/compatible/string",
          "title": "预共享密钥",
          "description": "预共享密钥",
          "markdownDescription": "预共享密钥"
        },
        "reserved": {
          "type": "array",
          "title": "保留字段值",
          "description": "部分WARP节点需要使用",
          "markdownDescription": "部分`WARP`节点需要使用"
        },
        "allowed-ips": {
          "$ref": "#/definitions/types/ipCIDRArray",
          "title": "允许进行流量转发的IP段",
          "description": "允许进行流量转发的IP段",
          "markdownDescription": "允许进行流量转发的IP段"
        }
      }
    }
  },
  "allOf": [
    { "title": "basic配置", "$ref": "#/definitions/basic-option" },
    {
      "type": "object",
      "title": "wireguard配置",
      "required": ["name", "private-key"],
      "properties": {
        "type": {
          "$ref": "#/definitions/compatible/string",
          "title": "代理节点类型",
          "description": "代理节点类型",
          "markdownDescription": "代理节点类型"
        },
        "name": {
          "$ref": "#/definitions/compatible/string",
          "title": "代理节点名称",
          "description": "代理节点名称",
          "markdownDescription": "代理节点名称"
        },
        "ip": {
          "$ref": "#/definitions/patterns/ipv4",
          "title": "本机在Wireguard网络中使用的IPv4地址",
          "description": "本机在Wireguard网络中使用的IPv4地址",
          "markdownDescription": "本机在`Wireguard`网络中使用的`IPv4`地址"
        },
        "ipv6": {
          "$ref": "#/definitions/patterns/ipv6",
          "title": "本机在Wireguard网络中使用的IPv6地址",
          "description": "本机在Wireguard网络中使用的IPv6地址",
          "markdownDescription": "本机在`Wireguard`网络中使用的`IPv6`地址"
        },
        "private-key": {
          "$ref": "#/definitions/compatible/string",
          "title": "私钥",
          "description": "私钥(Base64编码)",
          "markdownDescription": "私钥(`Base64`编码)"
        },
        "workers": {
          "$ref": "#/definitions/compatible/integer",
          "title": "工作线程",
          "description": "工作线程(默认为CPU逻辑核心数)",
          "markdownDescription": "工作线程(默认为CPU逻辑核心数)"
        },
        "mtu": {
          "$ref": "#/definitions/compatible/integer",
          "title": "最大传输单元",
          "description": "最大传输单元",
          "markdownDescription": "最大传输单元",
          "default": 1408
        },
        "udp": {
          "$ref": "#/definitions/compatible/boolean",
          "title": "启用UDP",
          "description": "启用UDP",
          "markdownDescription": "启用`UDP`",
          "default": true
        },
        "persistent-keepalive": {
          "$ref": "#/definitions/compatible/integer",
          "title": "持久保活间隔",
          "description": "单位:s",
          "markdownDescription": "单位:s"
        },
        "amnezia-wg-option": { "$ref": "#/definitions/amnezia-wg-option" },
        "peers": {
          "type": "array",
          "title": "peer配置",
          "description": "peer配置",
          "markdownDescription": "peer配置",
          "items": { "$ref": "#/definitions/wireguard-peer-option" }
        },
        "remote-dns-resolve": {
          "$ref": "#/definitions/compatible/boolean",
          "title": "强制DNS远程解析",
          "description": "强制DNS远程解析",
          "markdownDescription": "强制DNS远程解析",
          "default": false
        },
        "dns": {
          "$ref": "#/definitions/types/serverArray",
          "title": "DNS解析服务器",
          "description": "DNS解析服务器(要求启用remote-dns-resolve)",
          "markdownDescription": "DNS解析服务器(要求启用`remote-dns-resolve`)"
        },
        "refresh-server-ip-interval": {
          "$ref": "#/definitions/compatible/integer",
          "title": "服务器IP刷新间隔",
          "description": "单位:s",
          "markdownDescription": "单位:s"
        }
      },
      "if": { "not": { "properties": { "peers": { "type": "array" } } } },
      "then": { "$ref": "#/definitions/wireguard-peer-option" }
    },
    {
      "type": "object",
      "title": "smux配置",
      "properties": { "smux": { "title": "smux配置", "$ref": "#/definitions/smux" } }
    }
  ]
}
